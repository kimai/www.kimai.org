<!doctype html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="msapplication-TileColor" content="#2d89ef">
    <meta name="theme-color" content="#4188c9">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="robots" content="index,follow">
    <link rel="apple-touch-icon" sizes="180x180" href="https://www.kimai.org/images/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://www.kimai.org/images/icon_32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://www.kimai.org/images/icon_16x16.png">
    <title>Install Kimai on Ubuntu 22.04</title>
    <meta name="description" content="How to install Kimai on a brand new Ubuntu 22.04 with database, webserver and SSL certificate">
    <meta property="og:description" content="How to install Kimai on a brand new Ubuntu 22.04 with database, webserver and SSL certificate">
    <meta name="twitter:description" content="How to install Kimai on a brand new Ubuntu 22.04 with database, webserver and SSL certificate">
    <link type="application/atom+xml" rel="alternate" href="https://www.kimai.org/feed.xml" title="Kimai Time-Tracking" />
    <meta property="og:locale" content="en">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Kimai Time-Tracking">
    <meta property="og:image" content="https://www.kimai.org/images/social-preview.webp">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Kimai Time-Tracking">
    <meta name="twitter:site" content="@kimai_org">
    <meta name="twitter:image" content="https://www.kimai.org/images/social-preview.webp">
    <link rel="canonical" href="https://www.kimai.org/documentation/fresh-ubuntu-22.html" />
    <link href="/assets/build/main.css?v6" rel="stylesheet" />
</head>
<body class="">











<header class="header navbar navbar-expand bg-light border-bottom border-light shadow fixed-top" data-scroll-header>
    <div class="container-fluid pe-lg-4">
        <div class="d-flex align-items-center">
            <a href="/" class="navbar-brand flex-shrink-0 py-1 py-lg-2">
                <img src="/images/apple-touch-icon.png" width="32" alt="Kimai logo" class="me-2">
                Kimai Docs
            </a>
            <span class="badge bg-warning">On-Premise</span>
        </div>
        <div class="d-flex align-items-center w-100">
            <ul class="navbar-nav d-none d-lg-flex" style="padding-left: 6.75rem;">
                
                    
                    
                    <li class="nav-item">
                        <a href="/documentation/chapter-manual.html" class="nav-link ">
                            <i class="bx bx-book opacity-70 fs-lg me-1"></i>
                            User manual
                        </a>
                    </li>
                
                    
                    
                    <li class="nav-item">
                        <a href="/documentation/cloud.html" class="nav-link ">
                            <i class="bx bx-cloud opacity-70 fs-lg me-1"></i>
                            Kimai-Cloud
                        </a>
                    </li>
                
                    
                    
                    <li class="nav-item">
                        <a href="/documentation/chapter-on-premise.html" class="nav-link  active">
                            <i class="bx bx-server opacity-70 fs-lg me-1"></i>
                            On-Premise
                        </a>
                    </li>
                
                    
                    
                    <li class="nav-item">
                        <a href="/documentation/chapter-developer.html" class="nav-link ">
                            <i class="bx bx-code-alt opacity-70 fs-lg me-1"></i>
                            Developer
                        </a>
                    </li>
                
            </ul>
            <button type="button" class="navbar-toggler d-block d-lg-none ms-auto me-4" data-bs-toggle="offcanvas" data-bs-target="#componentsNav" aria-controls="componentsNav" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
        </div>
    </div>
</header>

<aside class="bg-dark">
    <div id="componentsNav" class="offcanvas-lg offcanvas-start d-flex flex-column position-fixed top-0 start-0 vh-100 bg-dark border-end-lg" style="width: 19rem; z-index: 1045;">
        <div class="offcanvas-header d-none d-lg-flex justify-content-start">
            <a href="/" class="navbar-brand d-none d-lg-flex py-0">
                <img src="/images/apple-touch-icon.png" width="26" alt="Kimai logo" class="me-3">
                Kimai Docs
            </a>
        </div>
        <div class="offcanvas-header d-block d-lg-none border-bottom">
            <div class="d-flex align-items-center justify-content-between mb-3">
                <h5 class="d-lg-none mb-0">Menu</h5>
                <button type="button" class="btn-close d-lg-none" data-bs-dismiss="offcanvas" data-bs-target="#componentsNav" aria-label="Close"></button>
            </div>
            <div class="list-group list-group-flush mx-n4">
                
                    
                    
                    <a href="/documentation/chapter-manual.html" class="list-group-item list-group-item-action d-flex align-items-center border-0 py-1 px-4">
                        <i class="bx bx-book opacity-70 me-1"></i>
                        User manual
                    </a>
                
                    
                    
                    <a href="/documentation/cloud.html" class="list-group-item list-group-item-action d-flex align-items-center border-0 py-1 px-4">
                        <i class="bx bx-cloud opacity-70 me-1"></i>
                        Kimai-Cloud
                    </a>
                
                    
                    
                    <a href="/documentation/chapter-on-premise.html" class="list-group-item list-group-item-action d-flex align-items-center border-0 py-1 px-4">
                        <i class="bx bx-server opacity-70 me-1"></i>
                        On-Premise
                    </a>
                
                    
                    
                    <a href="/documentation/chapter-developer.html" class="list-group-item list-group-item-action d-flex align-items-center border-0 py-1 px-4">
                        <i class="bx bx-code-alt opacity-70 me-1"></i>
                        Developer
                    </a>
                
            </div>
        </div>
        <div class="offcanvas-body overflow-scroll w-100 p-4">
            <div class="h-auto docsnavi">
                
                    
                    
                    
                    
                    <p class="fs-lg mb-1 text-white fw-bold">Cloud setups</p>
                    <div class="list-group list-group-flush mb-4 me-n4 border-start">
                        
                        
                        
                        
                        <a href="/documentation/hosting-hetzner-cloud.html" class="list-group-item ms-2 list-group-item-action border-0 ps-2 " id="docnavi-hosting-hetzner-cloud">
                            
                            Hetzner Cloud
                            
                        </a>
                        
                        
                        
                        
                        
                        <a href="/documentation/hosting-digital-ocean.html" class="list-group-item ms-2 list-group-item-action border-0 ps-2 " id="docnavi-hosting-digital-ocean">
                            
                            DigitalOcean
                            
                        </a>
                        
                        
                    </div>
                    
                    
                    
                    <p class="fs-lg mb-1 text-white fw-bold">Using Docker</p>
                    <div class="list-group list-group-flush mb-4 me-n4 border-start">
                        
                        
                        
                        
                        <a href="/documentation/docker.html" class="list-group-item ms-2 list-group-item-action border-0 ps-2 " id="docnavi-docker">
                            
                            Docker
                            
                        </a>
                        
                        
                        
                        
                        
                        <a href="/documentation/docker-compose.html" class="list-group-item ms-2 list-group-item-action border-0 ps-2 " id="docnavi-docker-compose">
                            
                            Docker Compose
                            
                        </a>
                        
                        
                        
                        
                        
                        <a href="/documentation/kubernetes.html" class="list-group-item ms-2 list-group-item-action border-0 ps-2 " id="docnavi-kubernetes">
                            
                            Kubernetes
                            
                        </a>
                        
                        
                        
                        
                        
                        <a href="/documentation/building-docker.html" class="list-group-item ms-2 list-group-item-action border-0 ps-2 " id="docnavi-building-docker">
                            
                            Build your image
                            
                        </a>
                        
                        
                        
                        
                        
                        <a href="/documentation/docker-troubleshooting.html" class="list-group-item ms-2 list-group-item-action border-0 ps-2 " id="docnavi-docker-troubleshooting">
                            
                            Troubleshooting
                            
                        </a>
                        
                        
                    </div>
                    
                    
                    
                    <p class="fs-lg mb-1 text-white fw-bold">Setup with SSH</p>
                    <div class="list-group list-group-flush mb-4 me-n4 border-start">
                        
                        
                        
                        
                        <a href="/documentation/installation.html" class="list-group-item ms-2 list-group-item-action border-0 ps-2 " id="docnavi-installation">
                            
                            Installation
                            
                        </a>
                        
                        
                        
                        
                        
                        <a href="/documentation/updates.html" class="list-group-item ms-2 list-group-item-action border-0 ps-2 " id="docnavi-updates">
                            
                            Updates
                            
                        </a>
                        
                        
                        
                        
                        
                        <a href="/documentation/cache.html" class="list-group-item ms-2 list-group-item-action border-0 ps-2 " id="docnavi-cache">
                            
                            Reloading cache
                            
                        </a>
                        
                        
                        
                        
                        
                        <a href="/documentation/plugin-management.html" class="list-group-item ms-2 list-group-item-action border-0 ps-2 " id="docnavi-plugin-management">
                            
                            Plugins
                            
                        </a>
                        
                        
                    </div>
                    
                    
                    
                    <p class="fs-lg mb-1 text-white fw-bold">Other setups</p>
                    <div class="list-group list-group-flush mb-4 me-n4 border-start">
                        
                        
                        
                        
                        <a href="/documentation/fresh-ubuntu-22.html" class="list-group-item ms-2 list-group-item-action border-0 ps-2  active" id="docnavi-fresh-ubuntu-22">
                            
                            Ubuntu 22.04
                            
                        </a>
                        
                        
                        
                        
                        
                        <a href="/documentation/webserver-configuration.html" class="list-group-item ms-2 list-group-item-action border-0 ps-2 " id="docnavi-webserver-configuration">
                            
                            Webserver
                            
                        </a>
                        
                        
                        
                        
                        
                        <a href="/documentation/synology.html" class="list-group-item ms-2 list-group-item-action border-0 ps-2 " id="docnavi-synology">
                            
                            Synology NAS
                            
                        </a>
                        
                        
                        
                        
                        
                        <a href="/documentation/shared-hosting.html" class="list-group-item ms-2 list-group-item-action border-0 ps-2 " id="docnavi-shared-hosting">
                            
                            Shared hosting
                            
                        </a>
                        
                        
                        
                        
                        
                        <a href="/documentation/hosting-1-click.html" class="list-group-item ms-2 list-group-item-action border-0 ps-2 " id="docnavi-hosting-1-click">
                            
                            1-click installations
                            
                        </a>
                        
                        
                    </div>
                    
                    
                    
                    <p class="fs-lg mb-1 text-white fw-bold">DevOps</p>
                    <div class="list-group list-group-flush mb-4 me-n4 border-start">
                        
                        
                        
                        
                        <a href="/documentation/backups.html" class="list-group-item ms-2 list-group-item-action border-0 ps-2 " id="docnavi-backups">
                            
                            Backups
                            
                        </a>
                        
                        
                        
                        
                        
                        <a href="/documentation/local-yaml.html" class="list-group-item ms-2 list-group-item-action border-0 ps-2 " id="docnavi-local-yaml">
                            
                            Configuration files
                            
                        </a>
                        
                        
                        
                        
                        
                        <a href="/documentation/emails.html" class="list-group-item ms-2 list-group-item-action border-0 ps-2 " id="docnavi-emails">
                            
                            Emails
                            
                        </a>
                        
                        
                        
                        
                        
                        <a href="/documentation/logging.html" class="list-group-item ms-2 list-group-item-action border-0 ps-2 " id="docnavi-logging">
                            
                            Logging
                            
                        </a>
                        
                        
                        
                        
                        
                        <a href="/documentation/commands.html" class="list-group-item ms-2 list-group-item-action border-0 ps-2 " id="docnavi-commands">
                            
                            Commands
                            
                        </a>
                        
                        
                        
                        
                        
                        <a href="/documentation/faq-onpremise.html" class="list-group-item ms-2 list-group-item-action border-0 ps-2 " id="docnavi-faq-onpremise">
                            
                            FAQ
                            
                        </a>
                        
                        
                        
                        
                        
                        <a href="/documentation/migration-v1.html" class="list-group-item ms-2 list-group-item-action border-0 ps-2 " id="docnavi-migration-v1">
                            
                            Migrate from Kimai v1
                            
                        </a>
                        
                        
                        
                        
                        
                        <a href="/documentation/versions.html" class="list-group-item ms-2 list-group-item-action border-0 ps-2 " id="docnavi-versions">
                            
                            Kimai versions
                            
                        </a>
                        
                        
                    </div>
                    
                    
                    
                    <p class="fs-lg mb-1 text-white fw-bold">Authenticator</p>
                    <div class="list-group list-group-flush mb-4 me-n4 border-start">
                        
                        
                        
                        
                        <a href="/documentation/ldap.html" class="list-group-item ms-2 list-group-item-action border-0 ps-2 " id="docnavi-ldap">
                            
                            LDAP
                            
                        </a>
                        
                        
                        
                        
                        
                        <a href="/documentation/saml.html" class="list-group-item ms-2 list-group-item-action border-0 ps-2 " id="docnavi-saml">
                            
                            SAML
                            
                        </a>
                        
                        
                        
                        
                        
                        <a href="/documentation/saml-azure.html" class="list-group-item ms-2 list-group-item-action border-0 ps-2 " id="docnavi-saml-azure">
                            
                            Azure SAML
                            
                        </a>
                        
                        
                        
                        
                        
                        <a href="/documentation/saml-google.html" class="list-group-item ms-2 list-group-item-action border-0 ps-2 " id="docnavi-saml-google">
                            
                            Google SAML
                            
                        </a>
                        
                        
                        
                        
                        
                        <a href="/documentation/saml-keycloak.html" class="list-group-item ms-2 list-group-item-action border-0 ps-2 " id="docnavi-saml-keycloak">
                            
                            Keycloak SAML
                            
                        </a>
                        
                        
                        
                        
                        
                        <a href="/documentation/saml-authentik.html" class="list-group-item ms-2 list-group-item-action border-0 ps-2 " id="docnavi-saml-authentik">
                            
                            Authentik SAML
                            
                        </a>
                        
                        
                        
                        
                        
                        <a href="/documentation/saml-adfs.html" class="list-group-item ms-2 list-group-item-action border-0 ps-2 " id="docnavi-saml-adfs">
                            
                            Microsoft ADFS
                            
                        </a>
                        
                        
                    </div>
                    
                    
                    
                    <p class="fs-lg mb-1 text-white fw-bold">Plugins</p>
                    <div class="list-group list-group-flush mb-4 me-n4 border-start">
                        
                        
                        
                        
                        <a href="/documentation/plugin-contract.html" class="list-group-item ms-2 list-group-item-action border-0 ps-2 " id="docnavi-plugin-contract">
                            
                            Working contract
                            
                        </a>
                        
                        
                    </div>
                    
                    <div class="list-group list-group-flush pb-3 mb-4 mx-n4">
                
                    <a href="/" class="list-group-item list-group-item-action border-0 py-1 fs-sm px-4">Kimai Home</a>
                    <a href="/en/site-notice.html" class="list-group-item list-group-item-action border-0 py-1 fs-sm px-4">Site notice</a>
                    <a href="/en/privacy-policy.html" class="list-group-item list-group-item-action border-0 py-1 fs-sm px-4">Privacy policy</a>
                </div>
            </div>
        </div>
    </div>
</aside>
<script>
    document.addEventListener("DOMContentLoaded", function(event) {
        const dpm = document.getElementById('docnavi-fresh-ubuntu-22');
        if (dpm !== null) {
            dpm.scrollIntoView({ behavior: "smooth", block: "end", inline: "nearest" });
        }
    });
</script>
<main class="docs-container pt-5">
    <div class="container-fluid px-xxl-5 px-lg-4 pt-4 pt-lg-5 pb-2 pb-lg-4">

        <div class="d-sm-flex align-items-end justify-content-between ps-lg-2 ps-xxl-0 mt-2 mt-lg-0 pt-4 mb-n3">
            <div class="me-4">
                <h1 class="pb-1">Install Kimai on Ubuntu 22.04</h1>
                
                <p class="text-muted fs-lg mb-2">How to install Kimai on a brand new Ubuntu 22.04 with database, webserver and SSL certificate</p>
                
            </div>
            





        </div>

        <div class="markdown py-5 ps-lg-2 ps-xxl-0">
            <div>
                
                <div id="documentation-content">
                    <div class="card border-primary mb-3">
                       <p class="card-title bg-faded-primary p-1 mb-1"><strong><i class="bx bxs-info-circle ms-2 me-2 text-primary fs-5"></i>Self-hosting knowledge prerequisites</strong></p>
                       <div class="card-body card-note m-0 pt-3 px-3">
<p>Self-hosting Kimai requires technical knowledge, including:</p>

<ul>
  <li>Setting up and configuring servers and containers</li>
  <li>Managing application resources and scaling</li>
  <li>Securing servers and applications</li>
  <li>Configuring Kimai</li>
</ul>

<p>Kimai recommends self-hosting for expert users. Mistakes can lead to data loss, security issues, and downtime. If you aren’t experienced at managing servers, Kimai recommends the <a href="/en/pricing" class="external-link">hosted cloud</a>.</p>
</div>
                   </div>

<p>This is a collection of snippets to help you with setting up a fresh Ubuntu 22.04 LTS server for using with Kimai.
It is neither a fully fledged documentation, explaining each step, nor is it a bash tutorial.</p>

<p>Please see it as a personal snippet collection… in which I assume:</p>
<ul>
  <li>that you are familiar with the Linux bash and have at least basic knowledge of vim</li>
  <li>that you use a single domain on this server, change the nginx configuration accordingly if you have multiple VirtualHosts</li>
  <li>that you know how to protect your server (UFW, Fail2Ban …) and can securely run it in the public internet</li>
</ul>

<p>You must additionally:</p>
<ul>
  <li>replace <code class="language-plaintext highlighter-rouge">IP-of-myserver</code> with the server IP</li>
  <li>replace the username <code class="language-plaintext highlighter-rouge">kevin</code> with your own</li>
  <li>replace the domain <code class="language-plaintext highlighter-rouge">www.kimai.local</code> with your own</li>
</ul>

<h2 id="accounts-and-ssh-connection">Accounts and SSH connection</h2>

<p>We start on our local machine, connect to the server and create our real user account:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ssh root@IP-of-myserver

useradd <span class="nt">-m</span> <span class="nt">-s</span> /bin/bash kevin
passwd kevin
</code></pre></div></div>

<p>Enable sudo access for this new user:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>visudo /etc/sudoers.d/kevin
</code></pre></div></div>

<p>And paste this one line:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kevin   ALL=(ALL:ALL) ALL
</code></pre></div></div>

<p>Back to our local machine:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">exit</span>
</code></pre></div></div>

<p>Generate your SSH key and sent it to your server:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ssh-keygen <span class="nt">-f</span> ~/.ssh/myserver_rsa
ssh-copy-id <span class="nt">-i</span> ~/.ssh/myserver_rsa.pub kevin@IP-of-myserver
</code></pre></div></div>

<p>Then edit your local SSH config:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vim ~/.ssh/config
</code></pre></div></div>

<p>And paste this:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Host myserver
    HostName IP-of-myserver
    IdentityFile ~/.ssh/myserver_rsa
    User kevin
</code></pre></div></div>

<p>And finally on to the server to start the software installation:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ssh myserver
</code></pre></div></div>

<h3 id="secure-your-ssh-daemon">Secure your SSH daemon</h3>

<p>Make sure your SSH server has at least some basic security settings in place:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>su
vim /etc/ssh/sshd_config
</code></pre></div></div>

<p>Change those:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PermitRootLogin no
PasswordAuthentication no
</code></pre></div></div>

<p>And restart the SSH Daemon:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>service sshd restart
</code></pre></div></div>

<h2 id="install-php-webserver-and-database">Install PHP, webserver and database</h2>

<p>Let’s start with all required software:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>apt-get update
apt-get upgrade
apt-get <span class="nb">install </span>git unzip curl vim mariadb-server mariadb-client nginx
apt-get <span class="nb">install </span>software-properties-common
</code></pre></div></div>

<p>Now install PHP 8.3:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>apt-get <span class="nb">install </span>php8.3 php8.3-curl php8.3-fpm php8.3-gd php8.3-intl php8.3-mbstring php8.3-mysql php8.3-opcache php8.3-xml php8.3-zip
</code></pre></div></div>

<h2 id="install-composer">Install composer</h2>

<p>Grab the latest <code class="language-plaintext highlighter-rouge">hash</code> from the <a href="https://getcomposer.org/download/">composer download page</a> and then execute:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>php <span class="nt">-r</span> <span class="s2">"copy('https://getcomposer.org/installer', 'composer-setup.php');"</span>
php <span class="nt">-r</span> <span class="s2">"if (hash_file('sha384', 'composer-setup.php') === '906a84df04cea2aa72f40b5f787e49f22d4c2f19492ac310e8cba5b96ac8b64115ac402c8cd292b8a03482574915d1a8') { echo 'Installer verified'; } else { echo 'Installer corrupt'; unlink('composer-setup.php'); } echo PHP_EOL;"</span>
</code></pre></div></div>

<p>Only proceed if you see: <strong>Installer verified</strong>!</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>php composer-setup.php
php <span class="nt">-r</span> <span class="s2">"unlink('composer-setup.php');"</span>
<span class="nb">chmod</span> +x composer.phar
<span class="nb">mv </span>composer.phar /usr/bin/composer
</code></pre></div></div>

<h2 id="create-database">Create database</h2>

<p>Connect to your database as root user:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>su
mysql <span class="nt">-u</span> root
</code></pre></div></div>

<p>And execute the following statements:</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">DATABASE</span> <span class="n">IF</span> <span class="k">NOT</span> <span class="k">EXISTS</span> <span class="nv">`kimai`</span><span class="p">;</span>
<span class="k">CREATE</span> <span class="k">USER</span> <span class="n">IF</span> <span class="k">NOT</span> <span class="k">EXISTS</span> <span class="nv">`kimai`</span><span class="o">@</span><span class="mi">127</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span> <span class="n">IDENTIFIED</span> <span class="k">BY</span> <span class="nv">"my-super-secret-password"</span><span class="p">;</span>
<span class="k">GRANT</span> <span class="k">select</span><span class="p">,</span><span class="k">insert</span><span class="p">,</span><span class="k">update</span><span class="p">,</span><span class="k">delete</span><span class="p">,</span><span class="k">create</span><span class="p">,</span><span class="k">alter</span><span class="p">,</span><span class="k">drop</span><span class="p">,</span><span class="k">index</span><span class="p">,</span><span class="k">references</span> <span class="k">ON</span> <span class="nv">`kimai`</span><span class="p">.</span><span class="o">*</span> <span class="k">TO</span> <span class="n">kimai</span><span class="o">@</span><span class="mi">127</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">;</span>
</code></pre></div></div>

<div class="alert alert-warning d-flex" role="alert"><i class="bx bx-alarm-exclamation lead me-3"></i><p>Replace “my-super-secret-password” with a strong password and probably change the username as well.</p>
</div>

<h2 id="install-kimai">Install Kimai</h2>

<p>Clone Kimai and set proper file permissions:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> /var/www/
git clone <span class="nt">-b</span> 2.28.0 <span class="nt">--depth</span> 1 https://github.com/kimai/kimai.git
<span class="nb">cd </span>kimai/
composer <span class="nb">install</span> <span class="nt">--no-dev</span> <span class="nt">--optimize-autoloader</span>
vim .env
</code></pre></div></div>

<div class="alert alert-info d-flex" role="alert"><i class="bx bx-message-rounded-detail lead me-3"></i><p>Please compare with the <a href="/documentation/installation.html">latest installation infos</a>, maybe something changed or was added in the meantime since writing this article.</p>
</div>

<p>Configure the database connection and adjust the settings to your needs (compare with the <a href="https://github.com/kimai/kimai/blob/main/.env.dist">original .env file</a>):</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>DATABASE_URL=mysql://kimai:my-super-secret-password@127.0.0.1:3306/kimai?charset=utf8mb4&amp;serverVersion=10.6.12-MariaDB
</code></pre></div></div>

<p>Then execute the Kimai installation:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bin/console kimai:install <span class="nt">-n</span>
bin/console kimai:user:create admin admin@example.com ROLE_SUPER_ADMIN
</code></pre></div></div>

<div class="card border-primary mb-3">
                       <p class="card-title bg-faded-primary p-1 mb-1"><strong><i class="bx bxs-info-circle ms-2 me-2 text-primary fs-5"></i>Adjust file permission</strong></p>
                       <div class="card-body card-note m-0 pt-3 px-3">
<p>You have to allow PHP (your webserver process) to write to <code class="language-plaintext highlighter-rouge">var/</code> and it subdirectories.</p>

<p>Here is an example for Debian/Ubuntu, to be executed inside the Kimai directory:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>chown -R :www-data .
chmod -R g+r .
chmod -R g+rw var/
</code></pre></div></div>

<p>You might not need these commands in a shared-hosting environment.
And you probably need to prefix them with <code class="language-plaintext highlighter-rouge">sudo</code> and/or the group might be called different from <code class="language-plaintext highlighter-rouge">www-data</code>.</p>
</div>
                   </div>

<p>Use <code class="language-plaintext highlighter-rouge">sudo</code> to run the commands to change file permissions.</p>

<h2 id="configure-webserver">Configure webserver</h2>

<p>Great! Now that we have done all these steps we only need the webserver and VirtualHost configuration:</p>

<div class="alert alert-info d-flex" role="alert"><i class="bx bx-message-rounded-detail lead me-3"></i><p>Check your PHP-FPM config for the fastcgi_pass (eg. version and socket).</p>
</div>

<p>This can be done with:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vim /etc/php/8.3/fpm/pool.d/www.conf
listen = /run/php/php8.3-fpm.sock
</code></pre></div></div>

<p>Edit/create the virtual host file:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vim /etc/nginx/sites-available/kimai
</code></pre></div></div>

<p>And paste the following configuration:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>server {
    listen 80 default_server;
    listen [::]:80 default_server;
    server_name www.kimai.local;
    root /var/www/kimai/public;
    index index.php;

    access_log off;
    log_not_found off;

    location ~ /\.ht {
        deny all;
    }

    location / {
        try_files $uri /index.php$is_args$args;
    }

    location ~ ^/index\.php(/|$) {
        fastcgi_pass unix:/run/php/php8.3-fpm.sock;
        fastcgi_split_path_info ^(.+\.php)(/.*)$;
        include fastcgi.conf;
        fastcgi_param PHP_ADMIN_VALUE "open_basedir=$document_root/..:/tmp/";
        internal;
    }

    location ~ \.php$ {
        return 404;
    }
}
</code></pre></div></div>

<p>Remove the Ubuntu default host and activate the site:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">unlink</span> /etc/nginx/sites-enabled/default
<span class="nb">ln</span> <span class="nt">-s</span> /etc/nginx/sites-available/kimai /etc/nginx/sites-enabled/kimai
nginx <span class="nt">-t</span> <span class="o">&amp;&amp;</span> service nginx reload
</code></pre></div></div>

<h3 id="install-certbot-for-ssl">Install Certbot for SSL</h3>

<p>Almost there, only the free Lets Encrypt SSL certificate is missing:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>apt-get <span class="nb">install </span>certbot python3-certbot-nginx
certbot <span class="nt">--nginx</span>
</code></pre></div></div>

<p>Follow the interactive dialogs and choose your new domain.
The <code class="language-plaintext highlighter-rouge">certbot</code> will rewrite your nginx site configuration and the https site should now work out-of-the-box.</p>

<p>Kimai is now up and running at www.kimai.local - enjoy!</p>

<h2 id="bonus-points">Bonus points</h2>

<p>The following points are hints for advanced use-cases. No support given!</p>

<h3 id="change-ssh-port">Change SSH Port</h3>

<p>By changing the default SSH port to a higher number, you can work around script-kiddies which use default “hacking tools” with default settings for their port-scans:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sed -i -e 's/#Port 22/Port 54321/g' /etc/ssh/sshd_config
service sshd restart
</code></pre></div></div>

<h3 id="ufw">UFW</h3>

<p>Enable the universal firewall and allow the new SSH port:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ufw allow from any to any port 22 proto tcp
ufw allow from any to any port 54321 proto tcp
ufw allow http
ufw allow https
ufw default allow outgoing
ufw default deny incoming
ufw <span class="nb">enable</span>
</code></pre></div></div>

<h3 id="fail2ban">Fail2Ban</h3>

<p>Install the <code class="language-plaintext highlighter-rouge">fail2ban</code> service and clone the Kimai plugin.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>apt-get <span class="nb">install </span>fail2ban
<span class="nb">cd</span> /var/www/kimai/var/plugins/
git clone https://github.com/Keleo/Fail2BanBundle.git
</code></pre></div></div>

<p>Now reload the Kimai cache and follow the instructions at <a href="https://github.com/Keleo/Fail2BanBundle">https://github.com/Keleo/Fail2BanBundle</a>.</p>

<p>Finally, enable <code class="language-plaintext highlighter-rouge">fail2ban</code> with:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>service fail2ban start
systemctl <span class="nb">enable </span>fail2ban
</code></pre></div></div>

                </div>
                

                
                <h2 id="related-articles" class="fs-4 mt-5">Related articles</h2>
                <ul>
                    
                    
                    <li>
                        <a href="/documentation/fresh-ubuntu-18.html">Install Kimai on Ubuntu 18.04</a> &ndash; How to install Kimai on a brand new Ubuntu 18.04 with database, webserver and SSL certificate
                    </li>
                    
                    
                    <li>
                        <a href="/documentation/fresh-ubuntu-20.html">Install Kimai on Ubuntu 20.04</a> &ndash; How to install Kimai on a brand new Ubuntu 20.04 with database, webserver and SSL certificate
                    </li>
                    
                </ul>
                
            </div>
        </div>

    </div>
</main>


    <aside class="side-nav side-nav-end d-none d-xxl-block position-fixed top-0 end-0 vh-100 py-5" style="width: 20rem;">
        <h3 class="fs-lg mt-5 pt-5">Jump to</h3>
        <ul class="nav" id="jumpToNav"><li class="nav-item"><a href="#accounts-and-ssh-connection" class="nav-link">Accounts and SSH connection</a><ul><li class="nav-item"><a href="#secure-your-ssh-daemon" class="nav-link">Secure your SSH daemon</a></li></ul></li><li class="nav-item"><a href="#install-php-webserver-and-database" class="nav-link">Install PHP, webserver and database</a></li><li class="nav-item"><a href="#install-composer" class="nav-link">Install composer</a></li><li class="nav-item"><a href="#create-database" class="nav-link">Create database</a></li><li class="nav-item"><a href="#install-kimai" class="nav-link">Install Kimai</a></li><li class="nav-item"><a href="#configure-webserver" class="nav-link">Configure webserver</a><ul><li class="nav-item"><a href="#install-certbot-for-ssl" class="nav-link">Install Certbot for SSL</a></li></ul></li><li class="nav-item"><a href="#bonus-points" class="nav-link">Bonus points</a><ul><li class="nav-item"><a href="#change-ssh-port" class="nav-link">Change SSH Port</a></li><li class="nav-item"><a href="#ufw" class="nav-link">UFW</a></li><li class="nav-item"><a href="#fail2ban" class="nav-link">Fail2Ban</a></li></ul></li></ul>
        
        <ul class="nav">
            <li>
                <a href="#related-articles" class="nav-link">Related articles</a>
            </li>
        </ul>
        
    </aside>



<a href="#top" class="btn-scroll-top" data-scroll>
    <span class="btn-scroll-top-tooltip text-muted fs-sm me-2">Top</span>
    <i class="btn-scroll-top-icon bx bx-chevron-up"></i>
</a>

<script src="/assets/build/main.js?v1"></script>

<script async defer src="https://sa.kimai.org/latest.js"></script>
<noscript><img src="https://sa.kimai.org/noscript.gif" alt="" referrerpolicy="no-referrer-when-downgrade" /></noscript>

</body>
</html>
